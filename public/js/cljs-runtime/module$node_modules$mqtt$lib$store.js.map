{
"version":3,
"file":"module$node_modules$mqtt$lib$store.js",
"lineCount":3,
"mappings":"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",
"sources":["node_modules/mqtt/lib/store.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mqtt$lib$store\"] = function(global,require,module,exports) {\n'use strict'\r\n\r\n/**\r\n * Module dependencies\r\n */\r\nvar xtend = require('xtend')\r\n\r\nvar Readable = require('readable-stream').Readable\r\nvar streamsOpts = { objectMode: true }\r\nvar defaultStoreOptions = {\r\n  clean: true\r\n}\r\n\r\n/**\r\n * In-memory implementation of the message store\r\n * This can actually be saved into files.\r\n *\r\n * @param {Object} [options] - store options\r\n */\r\nfunction Store (options) {\r\n  if (!(this instanceof Store)) {\r\n    return new Store(options)\r\n  }\r\n\r\n  this.options = options || {}\r\n\r\n  // Defaults\r\n  this.options = xtend(defaultStoreOptions, options)\r\n\r\n  this._inflights = new Map()\r\n}\r\n\r\n/**\r\n * Adds a packet to the store, a packet is\r\n * anything that has a messageId property.\r\n *\r\n */\r\nStore.prototype.put = function (packet, cb) {\r\n  this._inflights.set(packet.messageId, packet)\r\n\r\n  if (cb) {\r\n    cb()\r\n  }\r\n\r\n  return this\r\n}\r\n\r\n/**\r\n * Creates a stream with all the packets in the store\r\n *\r\n */\r\nStore.prototype.createStream = function () {\r\n  var stream = new Readable(streamsOpts)\r\n  var destroyed = false\r\n  var values = []\r\n  var i = 0\r\n\r\n  this._inflights.forEach(function (value, key) {\r\n    values.push(value)\r\n  })\r\n\r\n  stream._read = function () {\r\n    if (!destroyed && i < values.length) {\r\n      this.push(values[i++])\r\n    } else {\r\n      this.push(null)\r\n    }\r\n  }\r\n\r\n  stream.destroy = function () {\r\n    if (destroyed) {\r\n      return\r\n    }\r\n\r\n    var self = this\r\n\r\n    destroyed = true\r\n\r\n    setTimeout(function () {\r\n      self.emit('close')\r\n    }, 0)\r\n  }\r\n\r\n  return stream\r\n}\r\n\r\n/**\r\n * deletes a packet from the store.\r\n */\r\nStore.prototype.del = function (packet, cb) {\r\n  packet = this._inflights.get(packet.messageId)\r\n  if (packet) {\r\n    this._inflights.delete(packet.messageId)\r\n    cb(null, packet)\r\n  } else if (cb) {\r\n    cb(new Error('missing packet'))\r\n  }\r\n\r\n  return this\r\n}\r\n\r\n/**\r\n * get a packet from the store.\r\n */\r\nStore.prototype.get = function (packet, cb) {\r\n  packet = this._inflights.get(packet.messageId)\r\n  if (packet) {\r\n    cb(null, packet)\r\n  } else if (cb) {\r\n    cb(new Error('missing packet'))\r\n  }\r\n\r\n  return this\r\n}\r\n\r\n/**\r\n * Close the store\r\n */\r\nStore.prototype.close = function (cb) {\r\n  if (this.options.clean) {\r\n    this._inflights = null\r\n  }\r\n  if (cb) {\r\n    cb()\r\n  }\r\n}\r\n\r\nmodule.exports = Store\r\n\n};"],
"names":["shadow$provide","global","require","module","exports","Store","options","xtend","defaultStoreOptions","_inflights","Map","Readable","streamsOpts","objectMode","clean","prototype","put","Store.prototype.put","packet","cb","set","messageId","createStream","Store.prototype.createStream","stream","destroyed","values","i","forEach","value","key","push","_read","stream._read","length","destroy","stream.destroy","self","setTimeout","emit","del","Store.prototype.del","get","delete","Error","Store.prototype.get","close","Store.prototype.close"]
}
